(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{426:function(e,t,r){"use strict";r.r(t);var a=r(17),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"申请加入-微软office-365-e5-开发人员计划"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#申请加入-微软office-365-e5-开发人员计划"}},[e._v("#")]),e._v(" 申请加入 微软Office 365 E5 开发人员计划")]),e._v(" "),r("h1",{attrs:{id:"前言"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),r("p",[e._v("最近闲来无事，申请了个Office E5订阅，对我而言有用的是5T OneDrive（可扩容25T）")]),e._v(" "),r("p",[e._v("订阅有效期90天，证明是开发者即可续订。一共可以开25个子号。")]),e._v(" "),r("p",[e._v("至于证明是开发者，只要触发了OneDrive的API就可以证明是开发者了，当然不仅限于OneDrive，还算是比较简单的。")]),e._v(" "),r("h1",{attrs:{id:"申请过程"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#申请过程"}},[e._v("#")]),e._v(" 申请过程")]),e._v(" "),r("p",[e._v("Office开发人员中心链接："),r("a",{attrs:{href:"https://haoduck.com/go.html?url=https://developer.microsoft.com/zh-cn/office/dev-program",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://developer.microsoft.com/zh-cn/office/dev-program"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("打开链接就是大大的 "),r("strong",[e._v("立即加入")]),e._v(" 几个大字 （注：此过程也许国内网络访问并不友好）")]),e._v(" "),r("p",[r("img",{attrs:{src:"static/img/officee5_01.jpg",alt:"【记录】申请加入 微软Office 365 E5 开发人员计划"}})]),e._v(" "),r("p",[e._v("点 "),r("strong",[e._v("立即加入")]),e._v(" 就弹出填写信息的界面，如果你没有登录账号，就会让你登录。")]),e._v(" "),r("p",[e._v("填写信息正常填即可")]),e._v(" "),r("p",[r("img",{attrs:{src:"static/img/officee5_02.jpg",alt:"【记录】申请加入 微软Office 365 E5 开发人员计划"}})]),e._v(" "),r("p",[r("img",{attrs:{src:"static/img/officee5_03.jpg",alt:"【记录】申请加入 微软Office 365 E5 开发人员计划"}})]),e._v(" "),r("p",[r("img",{attrs:{src:"static/img/officee5_04.jpg",alt:"【记录】申请加入 微软Office 365 E5 开发人员计划"}})]),e._v(" "),r("p",[r("img",{attrs:{src:"static/img/officee5_05.jpg",alt:"【记录】申请加入 微软Office 365 E5 开发人员计划"}})]),e._v(" "),r("p",[e._v("到这里就OK了，可以订阅我们需要的 "),r("strong",[e._v("E5")]),e._v(" 了")]),e._v(" "),r("p",[e._v("点击 "),r("strong",[e._v("设置订阅")])]),e._v(" "),r("p",[e._v("填写你要设置的开发者账号的账号和密码")]),e._v(" "),r("p",[e._v("账号是一个邮箱的形式，用户名可以随意，域需要唯一")]),e._v(" "),r("p",[r("img",{attrs:{src:"static/img/officee5_06.jpg",alt:"【记录】申请加入 微软Office 365 E5 开发人员计划"}})]),e._v(" "),r("p",[r("img",{attrs:{src:"static/img/officee5_07.jpg",alt:"【记录】申请加入 微软Office 365 E5 开发人员计划"}})]),e._v(" "),r("p",[e._v("填好后点 "),r("strong",[e._v("继续")]),e._v(" 就完成了，成功订阅了E5。")]),e._v(" "),r("p",[r("img",{attrs:{src:"static/img/officee5_08.jpg",alt:"【记录】申请加入 微软Office 365 E5 开发人员计划"}})]),e._v(" "),r("h1",{attrs:{id:"管理e5订阅"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#管理e5订阅"}},[e._v("#")]),e._v(" 管理E5订阅")]),e._v(" "),r("p",[e._v("管理地址："),r("a",{attrs:{href:"https://haoduck.com/go.html?url=https://portal.office.com/AdminPortal/Home",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://portal.office.com/AdminPortal/Home"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("需要用你后面填的开发者账号登录")]),e._v(" "),r("h1",{attrs:{id:"修改onedrive容量"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#修改onedrive容量"}},[e._v("#")]),e._v(" 修改OneDrive容量")]),e._v(" "),r("h3",{attrs:{id:"修改默认容量"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#修改默认容量"}},[e._v("#")]),e._v(" 修改默认容量")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://haoduck.com/go.html?url=https://admin.onedrive.com/?v=StorageSettings",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://admin.onedrive.com/?v=StorageSettings"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("登录后将1024G改为5120G即可")]),e._v(" "),r("p",[e._v("注：此项设置需要一定时间生效。")]),e._v(" "),r("h3",{attrs:{id:"修改已有账号的容量"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#修改已有账号的容量"}},[e._v("#")]),e._v(" 修改已有账号的容量")]),e._v(" "),r("p",[e._v("需要用到 "),r("strong",[e._v("PowerShell")])]),e._v(" "),r("p",[e._v("下次再说")]),e._v(" "),r("h1",{attrs:{id:"扩容25t"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#扩容25t"}},[e._v("#")]),e._v(" 扩容25T")]),e._v(" "),r("h3",{attrs:{id:"扩容条件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#扩容条件"}},[e._v("#")]),e._v(" 扩容条件")]),e._v(" "),r("ul",[r("li",[e._v("有超过5个订阅的用户（即子号）")]),e._v(" "),r("li",[e._v("OneDrive 网盘使用量超过90%，子号亦可")])]),e._v(" "),r("h3",{attrs:{id:"提交扩容工单"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#提交扩容工单"}},[e._v("#")]),e._v(" 提交扩容工单")]),e._v(" "),r("p",[e._v("登录后台-支持-提交工单\n阐明你的使用量以及扩容的需求，等一段时间以后应该会收到技术人员会的电话，告诉你已经反馈到后台，让你等待大概1天即可升级完成。\n工单例：")]),e._v(" "),r("p",[e._v("标题：申请扩容OneDrive\n内容：你好！请帮我把admin@yaohuo.onmicrosoft.com的OneDrive的容量扩容到25T。谢谢！\n附件：截你的OneDrive使用量将满的图")]),e._v(" "),r("h1",{attrs:{id:"其他"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[e._v("#")]),e._v(" 其他")]),e._v(" "),r("p",[e._v("OneList——简单好用的OneDrive目录浏览程序："),r("a",{attrs:{href:"https://haoduck.com/go.html?url=https://blog.haoduck.com/302.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://blog.haoduck.com/302.html"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("Demo："),r("a",{attrs:{href:"https://haoduck.com/go.html?url=https://disk.gs",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://disk.gs"),r("OutboundLink")],1)]),e._v(" "),r("h1",{attrs:{id:"通过docker部署office-e5开发者订阅续期脚本实现自动续期"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#通过docker部署office-e5开发者订阅续期脚本实现自动续期"}},[e._v("#")]),e._v(" 通过Docker部署Office E5开发者订阅续期脚本实现自动续期")]),e._v(" "),r("p",[e._v("首先你要有一个Office E5开发者订阅，如果没有，你可以参考这篇文章申请一个。https://haoduck.com/305.html")]),e._v(" "),r("p",[e._v("其他基础的问题就不多说了，直接开始")]),e._v(" "),r("h2",{attrs:{id:"一、注册azure应用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#一、注册azure应用"}},[e._v("#")]),e._v(" 一、注册Azure应用")]),e._v(" "),r("p",[e._v("记得是用订阅下的子账号申请，也就是默认域名为"),r("code",[e._v("@xxxx.onmicrosoft.com")]),e._v("的账号。")]),e._v(" "),r("p",[e._v("登录Azure,"),r("a",{attrs:{href:"https://haoduck.com/go.html?url=https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("注册azure应用,确保应用有以下权限:\n"),r("code",[e._v("files: Files.Read.All、Files.ReadWrite.All、Sites.Read.All、Sites.ReadWrite.All")]),e._v(" "),r("code",[e._v("user:User.Read.All、User.ReadWrite.All、Directory.Read.All、Directory.ReadWrite.All")]),e._v(" "),r("code",[e._v("mail: Mail.Read、Mail.ReadWrite、MailboxSettings.Read、MailboxSettings.ReadWrite")])]),e._v(" "),r("p",[e._v("重定向URL写"),r("code",[e._v("http://localhost")]),e._v("即可，如果你还需要用其他Onedrive列表程序，可以把它们的重定向URL都写上去，比如这些。https://haoduck.com/578.html\n注册后一定要再点代表xxx授予管理员同意,否则outlook api无法调用")]),e._v(" "),r("h2",{attrs:{id:"二、安装rclone和获取refresh-token"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#二、安装rclone和获取refresh-token"}},[e._v("#")]),e._v(" 二、安装Rclone和获取"),r("code",[e._v("refresh_token")])]),e._v(" "),r("p",[e._v("Rclone官网下载地址："),r("a",{attrs:{href:"https://haoduck.com/go.html?url=https://rclone.org/downloads/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://rclone.org/downloads/"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("Linux下可以直接用官方一键脚本"),r("code",[e._v("curl https://rclone.org/install.sh | sudo bash")])]),e._v(" "),r("p",[e._v("怎么安装就不多说了，直接到配置这一块")]),e._v(" "),r("p",[e._v("配置"),r("code",[e._v("Onedrive")]),e._v("，其实也没什么好说的，就不上图了")]),e._v(" "),r("p",[e._v("到最后一步完成了，就能看到"),r("code",[e._v("refresh_token")]),e._v("了，是"),r("code",[e._v("0.A")]),e._v("开头的一长串，注意不要复制多了，也不要复制少了。")]),e._v(" "),r("h2",{attrs:{id:"三、使用docker镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#三、使用docker镜像"}},[e._v("#")]),e._v(" 三、使用Docker镜像")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('docker run -dit --name e5renew --restart always \\-e id="你的id" \\-e secret="你的secret" \\-e refresh_token="你的refresh_token" \\haoduck/e5renew\n')])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("平均每隔6小时调用API一次，这个6小时不是固定的，随机范围在十几分钟到2个多小时")]),e._v(" "),r("h2",{attrs:{id:"三、一键脚本"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#三、一键脚本"}},[e._v("#")]),e._v(" 三、一键脚本")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("bash <(curl -sL https://raw.githubusercontent.com/haoduck/E5Renew/main/onekey.sh)`\n或\n`bash <(curl -sL https://cdn.jsdelivr.net/gh/haoduck/E5Renew@main/onekey.sh)\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br")])]),r("h2",{attrs:{id:"四、查看运行日志"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#四、查看运行日志"}},[e._v("#")]),e._v(" 四、查看运行日志")]),e._v(" "),r("p",[e._v("Docker的运行日志"),r("code",[e._v("docker logs e5renew")])]),e._v(" "),r("p",[e._v("脚本的定时日志(等下次运行了才会有)"),r("code",[e._v("docker exec e5renew cat /work/crontab.log")])]),e._v(" "),r("p",[e._v("其中，"),r("code",[e._v("docker logs e5renew")]),e._v("里的"),r("code",[e._v("e5renew")]),e._v("是容器名，如果你有自定义容器名，对应修改命令。查看定时日志的命令同理。")]),e._v(" "),r("h2",{attrs:{id:"其他-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#其他-2"}},[e._v("#")]),e._v(" 其他")]),e._v(" "),r("p",[e._v("代码来源是在Github已经删掉的AutoApi项目")])])}),[],!1,null,null,null);t.default=s.exports}}]);